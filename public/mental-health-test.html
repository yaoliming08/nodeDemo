<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒç†å¥åº·è¯„ä¼°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 30px;
            color: #856404;
            font-size: 14px;
            line-height: 1.6;
        }

        .warning strong {
            display: block;
            margin-bottom: 5px;
        }

        .test-selector {
            margin-bottom: 30px;
        }

        .test-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .test-option {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .test-option:hover {
            border-color: #667eea;
            background: #f0f4ff;
            transform: translateY(-3px);
        }

        .test-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .test-option-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .test-option-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .test-option-desc {
            font-size: 12px;
            opacity: 0.9;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .question-container {
            display: none;
        }

        .question-container.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .question {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
        }

        .question-number {
            color: #667eea;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 20px;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f4ff;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .option-label {
            flex: 1;
            font-size: 16px;
            cursor: pointer;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-prev {
            background: #e0e0e0;
            color: #333;
        }

        .btn-prev:hover:not(:disabled) {
            background: #d0d0d0;
            transform: translateY(-2px);
        }

        .btn-next, .btn-submit {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-next:hover:not(:disabled), .btn-submit:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .result-container {
            display: none;
        }

        .result-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .result-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .result-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 32px;
            color: #333;
            margin-bottom: 15px;
        }

        .result-score {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
        }

        .result-level {
            font-size: 24px;
            color: #666;
            margin-bottom: 30px;
        }

        .result-description {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: left;
            line-height: 1.8;
            color: #555;
            font-size: 16px;
        }

        .result-suggestion {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .result-suggestion h3 {
            color: #1976D2;
            margin-bottom: 10px;
        }

        .result-suggestion ul {
            margin-left: 20px;
            color: #555;
        }

        .result-suggestion li {
            margin: 8px 0;
        }

        .btn-restart {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-top: 20px;
            padding: 12px 40px;
            display: block;
            margin: 30px auto 0;
        }

        .btn-restart:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .level-low { color: #4CAF50; }
        .level-mild { color: #FF9800; }
        .level-moderate { color: #FF5722; }
        .level-severe { color: #F44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¥ å¿ƒç†å¥åº·è¯„ä¼°</h1>
        <p class="subtitle">åŸºäºæƒå¨åŒ»å­¦é‡è¡¨ï¼Œç§‘å­¦è¯„ä¼°æ‚¨çš„å¿ƒç†å¥åº·çŠ¶å†µ</p>

        <div class="warning">
            <strong>âš ï¸ é‡è¦æç¤ºï¼š</strong>
            æœ¬æµ‹è¯•ä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—è¯Šæ–­ã€‚å¦‚æœ‰ä¸¥é‡å¿ƒç†å›°æ‰°ï¼Œè¯·åŠæ—¶å’¨è¯¢ä¸“ä¸šå¿ƒç†åŒ»ç”Ÿæˆ–ç²¾ç¥ç§‘åŒ»ç”Ÿã€‚
        </div>

        <!-- æµ‹è¯•é€‰æ‹©å™¨ -->
        <div class="test-selector" id="testSelector">
            <h2 style="text-align: center; margin-bottom: 20px; color: #333;">è¯·é€‰æ‹©è¦è¿›è¡Œçš„æµ‹è¯•</h2>
            <div class="test-options">
                <div class="test-option" onclick="selectTest('phq9')">
                    <div class="test-option-icon">ğŸ˜”</div>
                    <div class="test-option-title">æŠ‘éƒè¯„ä¼°</div>
                    <div class="test-option-desc">PHQ-9é‡è¡¨<br>9é“é¢˜ç›®</div>
                </div>
                <div class="test-option" onclick="selectTest('gad7')">
                    <div class="test-option-icon">ğŸ˜°</div>
                    <div class="test-option-title">ç„¦è™‘è¯„ä¼°</div>
                    <div class="test-option-desc">GAD-7é‡è¡¨<br>7é“é¢˜ç›®</div>
                </div>
                <div class="test-option" onclick="selectTest('mdq')">
                    <div class="test-option-icon">ğŸ”„</div>
                    <div class="test-option-title">åŒå‘æƒ…æ„Ÿéšœç¢</div>
                    <div class="test-option-desc">MDQé‡è¡¨<br>13é“é¢˜ç›®</div>
                </div>
                <div class="test-option" onclick="selectTest('pss')">
                    <div class="test-option-icon">ğŸ˜«</div>
                    <div class="test-option-title">å‹åŠ›è¯„ä¼°</div>
                    <div class="test-option-desc">PSSé‡è¡¨<br>10é“é¢˜ç›®</div>
                </div>
            </div>
        </div>

        <!-- è¿›åº¦æ¡ -->
        <div class="progress-text" id="progressText" style="display: none;">
            <span id="progressTextContent">0 / 0</span>
        </div>
        <div class="progress-bar" id="progressBar" style="display: none;">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <!-- é—®é¢˜å®¹å™¨ -->
        <div id="questionsContainer"></div>

        <!-- ç»“æœå®¹å™¨ -->
        <div class="result-container" id="resultContainer">
            <div class="result-header">
                <div class="result-icon" id="resultIcon">ğŸ“Š</div>
                <div class="result-title">è¯„ä¼°å®Œæˆ</div>
                <div class="result-score" id="resultScore"></div>
                <div class="result-level" id="resultLevel"></div>
            </div>
            <div class="result-description" id="resultDescription"></div>
            <div class="result-suggestion" id="resultSuggestion"></div>
            <button class="btn-restart" onclick="restartTest()">é‡æ–°æµ‹è¯•</button>
        </div>
    </div>

    <script>
        // æµ‹è¯•æ•°æ® - åŸºäºæƒå¨åŒ»å­¦é‡è¡¨
        const tests = {
            phq9: {
                name: 'æŠ‘éƒè¯„ä¼° (PHQ-9)',
                icon: 'ğŸ˜”',
                questions: [
                    { text: 'åšäº‹æ—¶æä¸èµ·åŠ²æˆ–æ²¡æœ‰å…´è¶£', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'æ„Ÿåˆ°å¿ƒæƒ…ä½è½ã€æ²®ä¸§æˆ–ç»æœ›', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'å…¥ç¡å›°éš¾ã€ç¡çœ ä¸ç¨³æˆ–ç¡çœ è¿‡å¤š', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'æ„Ÿåˆ°ç–²å€¦æˆ–æ²¡æœ‰æ´»åŠ›', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'é£Ÿæ¬²ä¸æŒ¯æˆ–åƒå¤ªå¤š', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'è§‰å¾—è‡ªå·±å¾ˆç³Ÿï¼Œæˆ–è§‰å¾—è‡ªå·±å¾ˆå¤±è´¥ï¼Œæˆ–è®©è‡ªå·±æˆ–å®¶äººå¤±æœ›', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'å¯¹äº‹ç‰©ä¸“æ³¨æœ‰å›°éš¾ï¼Œä¾‹å¦‚é˜…è¯»æŠ¥çº¸æˆ–çœ‹ç”µè§†æ—¶', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'åŠ¨ä½œæˆ–è¯´è¯é€Ÿåº¦ç¼“æ…¢åˆ°åˆ«äººå·²ç»å¯Ÿè§‰ï¼Œæˆ–æ­£å¥½ç›¸åï¼Œçƒ¦èºæˆ–åç«‹ä¸å®‰ã€åŠ¨æ¥åŠ¨å»çš„æƒ…å†µæ›´èƒœäºå¹³å¸¸', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'æœ‰ä¸å¦‚æ­»æ‰æˆ–ç”¨æŸç§æ–¹å¼ä¼¤å®³è‡ªå·±çš„å¿µå¤´', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]}
                ],
                evaluate: (score) => {
                    if (score <= 4) return {
                        level: 'æ— æˆ–æè½»å¾®',
                        levelClass: 'level-low',
                        description: 'æ‚¨çš„æŠ‘éƒç—‡çŠ¶éå¸¸è½»å¾®æˆ–ä¸å­˜åœ¨ï¼Œå¿ƒç†å¥åº·çŠ¶å†µè‰¯å¥½ã€‚',
                        suggestion: 'ç»§ç»­ä¿æŒè‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼Œè§„å¾‹ä½œæ¯ï¼Œé€‚å½“è¿åŠ¨ï¼Œä¿æŒç¤¾äº¤æ´»åŠ¨ã€‚'
                    };
                    if (score <= 9) return {
                        level: 'è½»åº¦æŠ‘éƒ',
                        levelClass: 'level-mild',
                        description: 'æ‚¨å¯èƒ½å­˜åœ¨è½»åº¦çš„æŠ‘éƒç—‡çŠ¶ã€‚å»ºè®®å…³æ³¨è‡ªå·±çš„æƒ…ç»ªå˜åŒ–ï¼Œé€‚å½“è°ƒæ•´ç”Ÿæ´»æ–¹å¼ã€‚',
                        suggestion: 'å»ºè®®ï¼š1) ä¿æŒè§„å¾‹ä½œæ¯ï¼›2) å¢åŠ æˆ·å¤–è¿åŠ¨ï¼›3) ä¸æœ‹å‹å®¶äººå¤šäº¤æµï¼›4) å¦‚ç—‡çŠ¶æŒç»­ï¼Œè€ƒè™‘å’¨è¯¢å¿ƒç†åŒ»ç”Ÿã€‚'
                    };
                    if (score <= 14) return {
                        level: 'ä¸­åº¦æŠ‘éƒ',
                        levelClass: 'level-moderate',
                        description: 'æ‚¨å­˜åœ¨ä¸­åº¦çš„æŠ‘éƒç—‡çŠ¶ï¼Œå»ºè®®å¯»æ±‚ä¸“ä¸šå¸®åŠ©ã€‚',
                        suggestion: 'å»ºè®®ï¼š1) å°½å¿«å’¨è¯¢ä¸“ä¸šå¿ƒç†åŒ»ç”Ÿæˆ–ç²¾ç¥ç§‘åŒ»ç”Ÿï¼›2) è€ƒè™‘æ¥å—å¿ƒç†æ²»ç–—æˆ–è¯ç‰©æ²»ç–—ï¼›3) ä¿æŒè§„å¾‹ä½œæ¯å’Œè¿åŠ¨ï¼›4) å¯»æ±‚å®¶äººæœ‹å‹çš„æ”¯æŒã€‚'
                    };
                    return {
                        level: 'ä¸­é‡åº¦è‡³é‡åº¦æŠ‘éƒ',
                        levelClass: 'level-severe',
                        description: 'æ‚¨å­˜åœ¨ä¸­é‡åº¦è‡³é‡åº¦çš„æŠ‘éƒç—‡çŠ¶ï¼Œå¼ºçƒˆå»ºè®®ç«‹å³å¯»æ±‚ä¸“ä¸šåŒ»ç–—å¸®åŠ©ã€‚',
                        suggestion: 'å¼ºçƒˆå»ºè®®ï¼š1) ç«‹å³å’¨è¯¢ç²¾ç¥ç§‘åŒ»ç”Ÿï¼›2) å¯èƒ½éœ€è¦è¯ç‰©æ²»ç–—ï¼›3) è€ƒè™‘å¿ƒç†æ²»ç–—ï¼›4) å¦‚æœ‰è‡ªä¼¤å¿µå¤´ï¼Œè¯·ç«‹å³æ‹¨æ‰“å¿ƒç†å±æœºå¹²é¢„çƒ­çº¿æˆ–å‰å¾€åŒ»é™¢æ€¥è¯Šç§‘ã€‚'
                    };
                }
            },
            gad7: {
                name: 'ç„¦è™‘è¯„ä¼° (GAD-7)',
                icon: 'ğŸ˜°',
                questions: [
                    { text: 'æ„Ÿè§‰ç´§å¼ ã€ç„¦è™‘æˆ–æ€¥èº', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'æ— æ³•åœæ­¢æˆ–æ§åˆ¶æ‹…å¿§', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'å¯¹å„ç§å„æ ·çš„äº‹æƒ…æ‹…å¿§è¿‡å¤š', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'å¾ˆéš¾æ”¾æ¾ä¸‹æ¥', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'ç”±äºä¸å®‰è€Œæ— æ³•é™å', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'å˜å¾—å®¹æ˜“çƒ¦æ¼æˆ–æ˜“æ€’', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]},
                    { text: 'æ„Ÿåˆ°å®³æ€•ï¼Œå¥½åƒä¼šå‘ç”Ÿä»€ä¹ˆå¯æ€•çš„äº‹æƒ…', options: [
                        { label: 'å®Œå…¨æ²¡æœ‰', score: 0 },
                        { label: 'å¥½å‡ å¤©', score: 1 },
                        { label: 'ä¸€åŠä»¥ä¸Šçš„å¤©æ•°', score: 2 },
                        { label: 'å‡ ä¹æ¯å¤©', score: 3 }
                    ]}
                ],
                evaluate: (score) => {
                    if (score <= 4) return {
                        level: 'æ— æˆ–æè½»å¾®',
                        levelClass: 'level-low',
                        description: 'æ‚¨çš„ç„¦è™‘ç—‡çŠ¶éå¸¸è½»å¾®æˆ–ä¸å­˜åœ¨ï¼Œå¿ƒç†å¥åº·çŠ¶å†µè‰¯å¥½ã€‚',
                        suggestion: 'ç»§ç»­ä¿æŒè‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼Œå­¦ä¹ æ”¾æ¾æŠ€å·§ï¼Œä¿æŒè§„å¾‹ä½œæ¯ã€‚'
                    };
                    if (score <= 9) return {
                        level: 'è½»åº¦ç„¦è™‘',
                        levelClass: 'level-mild',
                        description: 'æ‚¨å¯èƒ½å­˜åœ¨è½»åº¦çš„ç„¦è™‘ç—‡çŠ¶ã€‚å»ºè®®å…³æ³¨è‡ªå·±çš„æƒ…ç»ªå˜åŒ–ï¼Œå­¦ä¹ æ”¾æ¾æŠ€å·§ã€‚',
                        suggestion: 'å»ºè®®ï¼š1) å­¦ä¹ æ·±å‘¼å¸ã€å†¥æƒ³ç­‰æ”¾æ¾æŠ€å·§ï¼›2) ä¿æŒè§„å¾‹ä½œæ¯ï¼›3) é€‚å½“è¿åŠ¨ï¼›4) å¦‚ç—‡çŠ¶æŒç»­ï¼Œè€ƒè™‘å’¨è¯¢å¿ƒç†åŒ»ç”Ÿã€‚'
                    };
                    if (score <= 14) return {
                        level: 'ä¸­åº¦ç„¦è™‘',
                        levelClass: 'level-moderate',
                        description: 'æ‚¨å­˜åœ¨ä¸­åº¦çš„ç„¦è™‘ç—‡çŠ¶ï¼Œå»ºè®®å¯»æ±‚ä¸“ä¸šå¸®åŠ©ã€‚',
                        suggestion: 'å»ºè®®ï¼š1) å°½å¿«å’¨è¯¢ä¸“ä¸šå¿ƒç†åŒ»ç”Ÿæˆ–ç²¾ç¥ç§‘åŒ»ç”Ÿï¼›2) è€ƒè™‘æ¥å—å¿ƒç†æ²»ç–—æˆ–è¯ç‰©æ²»ç–—ï¼›3) å­¦ä¹ æ”¾æ¾æŠ€å·§ï¼›4) ä¿æŒè§„å¾‹ä½œæ¯å’Œè¿åŠ¨ã€‚'
                    };
                    return {
                        level: 'é‡åº¦ç„¦è™‘',
                        levelClass: 'level-severe',
                        description: 'æ‚¨å­˜åœ¨é‡åº¦çš„ç„¦è™‘ç—‡çŠ¶ï¼Œå¼ºçƒˆå»ºè®®ç«‹å³å¯»æ±‚ä¸“ä¸šåŒ»ç–—å¸®åŠ©ã€‚',
                        suggestion: 'å¼ºçƒˆå»ºè®®ï¼š1) ç«‹å³å’¨è¯¢ç²¾ç¥ç§‘åŒ»ç”Ÿï¼›2) å¯èƒ½éœ€è¦è¯ç‰©æ²»ç–—ï¼›3) è€ƒè™‘å¿ƒç†æ²»ç–—ï¼›4) å­¦ä¹ æ”¾æ¾æŠ€å·§å’Œåº”å¯¹ç­–ç•¥ã€‚'
                    };
                }
            },
            mdq: {
                name: 'åŒå‘æƒ…æ„Ÿéšœç¢è¯„ä¼° (MDQ)',
                icon: 'ğŸ”„',
                questions: [
                    { text: 'æ‚¨æ˜¯å¦æœ‰ä¸€æ®µæ—¶é—´æ„Ÿåˆ°æƒ…ç»ªé«˜æ¶¨ã€å…´å¥‹æˆ–æ˜“æ€’ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'åœ¨è¿™æ®µæ—¶é—´é‡Œï¼Œæ‚¨æ˜¯å¦æ„Ÿåˆ°æ¯”å¹³æ—¶æ›´è‡ªä¿¡ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨æ˜¯å¦æ¯”å¹³æ—¶éœ€è¦æ›´å°‘çš„ç¡çœ ï¼Œä½†ä»ç„¶æ„Ÿè§‰ä¼‘æ¯å¾—å¾ˆå¥½ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨æ˜¯å¦æ¯”å¹³æ—¶æ›´å¥è°ˆï¼Œæˆ–è€…æ„Ÿè§‰å¿…é¡»ä¸åœåœ°è¯´è¯ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨çš„æ€ç»´æ˜¯å¦æ¯”å¹³æ—¶æ›´å¿«ï¼Œæˆ–è€…æ„Ÿè§‰æ€ç»´åœ¨é£é€Ÿè¿è½¬ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨æ˜¯å¦å®¹æ˜“è¢«å‘¨å›´çš„äº‹ç‰©åˆ†æ•£æ³¨æ„åŠ›ï¼Œæˆ–è€…å‘ç°å¾ˆéš¾é›†ä¸­æ³¨æ„åŠ›ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨çš„ç²¾åŠ›æ˜¯å¦æ¯”å¹³æ—¶æ›´å……æ²›ï¼Œæˆ–è€…æ¯”å¹³æ—¶åšäº†æ›´å¤šçš„äº‹æƒ…ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨æ˜¯å¦æ¯”å¹³æ—¶æ›´å†²åŠ¨ï¼Œæˆ–è€…åšäº†å¹³æ—¶ä¸ä¼šåšçš„äº‹æƒ…ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨æ˜¯å¦æ¯”å¹³æ—¶æ›´æ´»è·ƒï¼Œæˆ–è€…åç«‹ä¸å®‰ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨æ˜¯å¦æœ‰ä¸€æ®µæ—¶é—´æ„Ÿåˆ°æƒ…ç»ªä½è½ã€æ²®ä¸§æˆ–ç»æœ›ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'åœ¨è¿™æ®µæ—¶é—´é‡Œï¼Œæ‚¨æ˜¯å¦å¯¹ä»¥å‰å–œæ¬¢åšçš„äº‹æƒ…å¤±å»äº†å…´è¶£ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'æ‚¨æ˜¯å¦æ„Ÿåˆ°ç–²å€¦æˆ–æ²¡æœ‰æ´»åŠ›ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]},
                    { text: 'è¿™äº›æƒ…ç»ªå˜åŒ–æ˜¯å¦å¯¹æ‚¨çš„å·¥ä½œã€å®¶åº­ç”Ÿæ´»æˆ–ç¤¾äº¤å…³ç³»é€ æˆäº†é—®é¢˜ï¼Ÿ', options: [
                        { label: 'æ˜¯', score: 1 },
                        { label: 'å¦', score: 0 }
                    ]}
                ],
                evaluate: (score, answers) => {
                    // MDQè¯„ä¼°ï¼šå‰9é¢˜è‡³å°‘7é¢˜ç­”"æ˜¯"ï¼Œä¸”ç¬¬13é¢˜ç­”"æ˜¯"
                    const first9Score = answers.slice(0, 9).reduce((sum, a) => sum + (a || 0), 0);
                    const lastAnswer = answers[12] || 0;
                    
                    if (first9Score >= 7 && lastAnswer === 1) {
                        return {
                            level: 'å¯èƒ½å­˜åœ¨åŒå‘æƒ…æ„Ÿéšœç¢',
                            levelClass: 'level-severe',
                            description: 'æ ¹æ®MDQé‡è¡¨è¯„ä¼°ï¼Œæ‚¨å¯èƒ½å­˜åœ¨åŒå‘æƒ…æ„Ÿéšœç¢çš„é£é™©ã€‚åŒå‘æƒ…æ„Ÿéšœç¢æ˜¯ä¸€ç§éœ€è¦ä¸“ä¸šæ²»ç–—çš„å¿ƒç†ç–¾ç—…ï¼Œè¡¨ç°ä¸ºæƒ…ç»ªåœ¨æŠ‘éƒå’Œèºç‹‚ä¹‹é—´æ³¢åŠ¨ã€‚',
                            suggestion: 'å¼ºçƒˆå»ºè®®ï¼š1) ç«‹å³å’¨è¯¢ç²¾ç¥ç§‘åŒ»ç”Ÿè¿›è¡Œä¸“ä¸šè¯„ä¼°ï¼›2) å¯èƒ½éœ€è¦è¯ç‰©æ²»ç–—ï¼›3) è€ƒè™‘å¿ƒç†æ²»ç–—ï¼›4) ä¿æŒè§„å¾‹ä½œæ¯ï¼Œé¿å…è¿‡åº¦åˆºæ¿€ï¼›5) å¯»æ±‚å®¶äººæœ‹å‹çš„æ”¯æŒã€‚'
                        };
                    }
                    if (first9Score >= 5) {
                        return {
                            level: 'éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°',
                            levelClass: 'level-moderate',
                            description: 'æ‚¨çš„ä¸€äº›ç—‡çŠ¶å€¼å¾—å…³æ³¨ï¼Œå»ºè®®è¿›è¡Œæ›´è¯¦ç»†çš„ä¸“ä¸šè¯„ä¼°ã€‚',
                            suggestion: 'å»ºè®®ï¼š1) å’¨è¯¢ä¸“ä¸šå¿ƒç†åŒ»ç”Ÿæˆ–ç²¾ç¥ç§‘åŒ»ç”Ÿï¼›2) è¯¦ç»†æè¿°æ‚¨çš„æƒ…ç»ªå˜åŒ–æƒ…å†µï¼›3) ä¿æŒè§„å¾‹ä½œæ¯ï¼›4) è®°å½•æƒ…ç»ªå˜åŒ–æ—¥è®°ã€‚'
                        };
                    }
                    return {
                        level: 'é£é™©è¾ƒä½',
                        levelClass: 'level-low',
                        description: 'æ ¹æ®MDQé‡è¡¨è¯„ä¼°ï¼Œæ‚¨å­˜åœ¨åŒå‘æƒ…æ„Ÿéšœç¢çš„é£é™©è¾ƒä½ã€‚',
                        suggestion: 'å»ºè®®ï¼š1) ç»§ç»­ä¿æŒè‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼›2) å…³æ³¨è‡ªå·±çš„æƒ…ç»ªå˜åŒ–ï¼›3) å¦‚æœ‰æ˜æ˜¾æƒ…ç»ªæ³¢åŠ¨ï¼ŒåŠæ—¶å’¨è¯¢ä¸“ä¸šåŒ»ç”Ÿã€‚'
                    };
                }
            },
            pss: {
                name: 'å‹åŠ›è¯„ä¼° (PSS)',
                icon: 'ğŸ˜«',
                questions: [
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡å› ä¸ºä¸€äº›æ„å¤–å‘ç”Ÿçš„äº‹æƒ…è€Œæ„Ÿåˆ°å¿ƒçƒ¦æ„ä¹±ï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 0 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 1 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 3 },
                        { label: 'éå¸¸ç»å¸¸', score: 4 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡æ„Ÿåˆ°æ— æ³•æ§åˆ¶ç”Ÿæ´»ä¸­é‡è¦çš„äº‹æƒ…ï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 0 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 1 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 3 },
                        { label: 'éå¸¸ç»å¸¸', score: 4 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡æ„Ÿåˆ°ç´§å¼ å’Œ"å‹åŠ›"ï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 0 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 1 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 3 },
                        { label: 'éå¸¸ç»å¸¸', score: 4 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡æ„Ÿåˆ°æœ‰ä¿¡å¿ƒèƒ½å¤Ÿå¤„ç†è‡ªå·±çš„ä¸ªäººé—®é¢˜ï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 4 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 3 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 1 },
                        { label: 'éå¸¸ç»å¸¸', score: 0 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡æ„Ÿåˆ°äº‹æƒ…çš„å‘å±•å¦‚æ‚¨æ‰€æ„¿ï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 4 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 3 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 1 },
                        { label: 'éå¸¸ç»å¸¸', score: 0 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡å‘ç°è‡ªå·±æ— æ³•åº”ä»˜æ‰€æœ‰å¿…é¡»åšçš„äº‹æƒ…ï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 0 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 1 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 3 },
                        { label: 'éå¸¸ç»å¸¸', score: 4 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡èƒ½å¤Ÿæ§åˆ¶ç”Ÿæ´»ä¸­çš„æ¼æ€’æƒ…ç»ªï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 4 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 3 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 1 },
                        { label: 'éå¸¸ç»å¸¸', score: 0 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡æ„Ÿåˆ°è‡ªå·±æ˜¯äº‹æƒ…çš„ä¸»å®°è€…ï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 4 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 3 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 1 },
                        { label: 'éå¸¸ç»å¸¸', score: 0 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡å› ä¸ºå‘ç”Ÿè¶…å‡ºæ‚¨æ§åˆ¶èŒƒå›´çš„äº‹æƒ…è€Œæ„Ÿåˆ°ç”Ÿæ°”ï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 0 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 1 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 3 },
                        { label: 'éå¸¸ç»å¸¸', score: 4 }
                    ]},
                    { text: 'åœ¨ä¸Šä¸ªæœˆï¼Œæ‚¨æœ‰å¤šå°‘æ¬¡æ„Ÿåˆ°å›°éš¾å †ç§¯å¦‚å±±ï¼Œæ— æ³•å…‹æœï¼Ÿ', options: [
                        { label: 'ä»æ¥æ²¡æœ‰', score: 0 },
                        { label: 'å‡ ä¹æ²¡æœ‰', score: 1 },
                        { label: 'æœ‰æ—¶', score: 2 },
                        { label: 'ç›¸å½“ç»å¸¸', score: 3 },
                        { label: 'éå¸¸ç»å¸¸', score: 4 }
                    ]}
                ],
                evaluate: (score) => {
                    if (score <= 13) return {
                        level: 'ä½å‹åŠ›',
                        levelClass: 'level-low',
                        description: 'æ‚¨çš„å‹åŠ›æ°´å¹³è¾ƒä½ï¼Œèƒ½å¤Ÿè¾ƒå¥½åœ°åº”å¯¹ç”Ÿæ´»ä¸­çš„æŒ‘æˆ˜ã€‚',
                        suggestion: 'ç»§ç»­ä¿æŒè‰¯å¥½çš„å‹åŠ›ç®¡ç†ä¹ æƒ¯ï¼Œä¿æŒè§„å¾‹ä½œæ¯ï¼Œé€‚å½“è¿åŠ¨ï¼Œä¿æŒç¤¾äº¤æ´»åŠ¨ã€‚'
                    };
                    if (score <= 26) return {
                        level: 'ä¸­ç­‰å‹åŠ›',
                        levelClass: 'level-mild',
                        description: 'æ‚¨å­˜åœ¨ä¸­ç­‰ç¨‹åº¦çš„å‹åŠ›ï¼Œéœ€è¦å…³æ³¨å‹åŠ›ç®¡ç†ã€‚',
                        suggestion: 'å»ºè®®ï¼š1) å­¦ä¹ å‹åŠ›ç®¡ç†æŠ€å·§ï¼›2) ä¿æŒè§„å¾‹ä½œæ¯ï¼›3) é€‚å½“è¿åŠ¨ï¼›4) å¯»æ±‚æ”¯æŒï¼›5) å¦‚å‹åŠ›æŒç»­ï¼Œè€ƒè™‘å’¨è¯¢å¿ƒç†åŒ»ç”Ÿã€‚'
                    };
                    return {
                        level: 'é«˜å‹åŠ›',
                        levelClass: 'level-severe',
                        description: 'æ‚¨çš„å‹åŠ›æ°´å¹³è¾ƒé«˜ï¼Œå¯èƒ½å½±å“èº«å¿ƒå¥åº·ï¼Œå»ºè®®é‡‡å–ç§¯ææªæ–½åº”å¯¹ã€‚',
                        suggestion: 'å»ºè®®ï¼š1) å°½å¿«å­¦ä¹ å‹åŠ›ç®¡ç†æŠ€å·§ï¼›2) è€ƒè™‘å’¨è¯¢å¿ƒç†åŒ»ç”Ÿï¼›3) ä¿æŒè§„å¾‹ä½œæ¯å’Œè¿åŠ¨ï¼›4) å¯»æ±‚å®¶äººæœ‹å‹çš„æ”¯æŒï¼›5) å¿…è¦æ—¶è°ƒæ•´å·¥ä½œæˆ–ç”Ÿæ´»å®‰æ’ã€‚'
                    };
                }
            }
        };

        let currentTest = null;
        let currentQuestion = 0;
        let answers = [];

        // é€‰æ‹©æµ‹è¯•
        function selectTest(testId) {
            currentTest = tests[testId];
            if (!currentTest) return;

            // æ›´æ–°UI
            document.querySelectorAll('.test-option').forEach(opt => opt.classList.remove('selected'));
            event.target.closest('.test-option').classList.add('selected');

            // éšè—é€‰æ‹©å™¨ï¼Œæ˜¾ç¤ºæµ‹è¯•
            document.getElementById('testSelector').style.display = 'none';
            document.getElementById('progressBar').style.display = 'block';
            document.getElementById('progressText').style.display = 'block';

            // åˆå§‹åŒ–æµ‹è¯•
            initTest();
        }

        // åˆå§‹åŒ–æµ‹è¯•
        function initTest() {
            answers = [];
            currentQuestion = 0;
            
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            
            currentTest.questions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-container';
                questionDiv.id = `question-${index}`;
                
                const optionsHtml = question.options.map((option, optIndex) => `
                    <label class="option" onclick="selectOption(${index}, ${optIndex})">
                        <input type="radio" name="question-${index}" value="${optIndex}">
                        <span class="option-label">${option.label}</span>
                    </label>
                `).join('');
                
                questionDiv.innerHTML = `
                    <div class="question">
                        <div class="question-number">é—®é¢˜ ${index + 1} / ${currentTest.questions.length}</div>
                        <div class="question-text">${question.text}</div>
                        <div class="options">${optionsHtml}</div>
                    </div>
                    <div class="button-group">
                        <button class="btn-prev" onclick="prevQuestion()" ${index === 0 ? 'disabled' : ''}>ä¸Šä¸€é¢˜</button>
                        ${index === currentTest.questions.length - 1 
                            ? '<button class="btn-submit" onclick="submitTest()">æäº¤æµ‹è¯•</button>'
                            : '<button class="btn-next" onclick="nextQuestion()">ä¸‹ä¸€é¢˜</button>'
                        }
                    </div>
                `;
                
                container.appendChild(questionDiv);
            });
            
            showQuestion(0);
            updateProgress();
        }

        // æ˜¾ç¤ºæŒ‡å®šé—®é¢˜
        function showQuestion(index) {
            document.querySelectorAll('.question-container').forEach((q, i) => {
                q.classList.toggle('active', i === index);
            });
            currentQuestion = index;
            updateProgress();
        }

        // é€‰æ‹©é€‰é¡¹
        function selectOption(questionIndex, optionIndex) {
            const question = currentTest.questions[questionIndex];
            const option = question.options[optionIndex];
            
            // æ›´æ–°ç­”æ¡ˆ
            answers[questionIndex] = option.score;
            
            // æ›´æ–°UI
            const questionDiv = document.getElementById(`question-${questionIndex}`);
            questionDiv.querySelectorAll('.option').forEach((opt, i) => {
                opt.classList.toggle('selected', i === optionIndex);
            });
        }

        // ä¸Šä¸€é¢˜
        function prevQuestion() {
            if (currentQuestion > 0) {
                showQuestion(currentQuestion - 1);
            }
        }

        // ä¸‹ä¸€é¢˜
        function nextQuestion() {
            if (answers[currentQuestion] === undefined) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆ');
                return;
            }
            
            if (currentQuestion < currentTest.questions.length - 1) {
                showQuestion(currentQuestion + 1);
            }
        }

        // æäº¤æµ‹è¯•
        function submitTest() {
            if (answers[currentQuestion] === undefined) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆ');
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰é¢˜ç›®éƒ½å·²å›ç­”
            if (answers.length !== currentTest.questions.length) {
                alert('è¯·å›ç­”æ‰€æœ‰é—®é¢˜');
                return;
            }
            
            // è®¡ç®—æ€»åˆ†
            const totalScore = answers.reduce((sum, score) => sum + (score || 0), 0);
            
            // è¯„ä¼°ç»“æœ
            const result = currentTest.evaluate(totalScore, answers);
            
            // æ˜¾ç¤ºç»“æœ
            showResult(totalScore, result);
            
            // å¯é€‰ï¼šä¿å­˜æµ‹è¯•ç»“æœ
            saveTestResult(currentTest.name, totalScore, result);
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(score, result) {
            document.getElementById('questionsContainer').style.display = 'none';
            document.querySelector('.progress-bar').style.display = 'none';
            document.querySelector('.progress-text').style.display = 'none';
            
            document.getElementById('resultIcon').textContent = currentTest.icon;
            document.getElementById('resultScore').textContent = `å¾—åˆ†: ${score}`;
            document.getElementById('resultLevel').textContent = result.level;
            document.getElementById('resultLevel').className = `result-level ${result.levelClass}`;
            document.getElementById('resultDescription').textContent = result.description;
            document.getElementById('resultSuggestion').innerHTML = `
                <h3>ğŸ’¡ å»ºè®®</h3>
                <div>${result.suggestion}</div>
            `;
            
            document.getElementById('resultContainer').classList.add('show');
        }

        // ä¿å­˜æµ‹è¯•ç»“æœï¼ˆå¯é€‰ï¼‰
        async function saveTestResult(testName, score, result) {
            try {
                const response = await fetch('http://localhost:3000/api/mental-health-test', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        testName: testName,
                        score: score,
                        level: result.level
                    })
                });
                console.log('æµ‹è¯•ç»“æœå·²ä¿å­˜');
            } catch (error) {
                console.log('ä¿å­˜æµ‹è¯•ç»“æœå¤±è´¥ï¼ˆä¸å½±å“æµ‹è¯•ï¼‰:', error);
            }
        }

        // é‡æ–°å¼€å§‹æµ‹è¯•
        function restartTest() {
            document.getElementById('resultContainer').classList.remove('show');
            document.getElementById('testSelector').style.display = 'block';
            document.getElementById('questionsContainer').style.display = 'block';
            document.getElementById('progressBar').style.display = 'none';
            document.getElementById('progressText').style.display = 'none';
            document.getElementById('questionsContainer').innerHTML = '';
            currentTest = null;
            answers = [];
            currentQuestion = 0;
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            if (!currentTest) return;
            const progress = ((currentQuestion + 1) / currentTest.questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressTextContent').textContent = `${currentQuestion + 1} / ${currentTest.questions.length}`;
        }
    </script>
</body>
</html>


